<!-- modulo.component.html -->
<div class="modulo">
  <main class="main-content">
    <!-- Mensaje de bienvenida -->
    <div class="welcome-message">
      <h2 class="welcome-text">Bienvenido a Módulos</h2>
    </div>

    <!-- Campo de búsqueda -->
    <div class="search-container">
      <input type="text" [(ngModel)]="searchTerm" placeholder="Buscar empresa..." />
    </div>

    <!-- Sección de tarjetas de empresas -->
    <section class="info-cards">
      <!-- Tarjeta fija para 'incendio' -->
      <div class="info-card" [routerLink]="['/incendio']" routerLinkActive="active">
        <img src="assets/logo-Vitelsa-nuevo.png" alt="Logo" class="img-fluid">
        <p>Incendio</p>
      </div>

      <!-- Tarjetas dinámicas de empresas con filtro -->
      <div *ngFor="let empresa of filteredEmpresas()" class="info-wrapper">
        <div class="info-card"
             [routerLink]="['/tabla', empresa.nombre_tabla]"
             routerLinkActive="active"
             [ngStyle]="{'background-color': empresa.color_palette}">

          <!-- Logo de la empresa -->
          <img *ngIf="empresa.logo_empresa" [src]="empresa.logo_empresa" alt="Logo" class="img-fluid logo">

          <!-- Botones de acción -->
          <div class="action-buttons">
            <button class="btn btn-sm btn-danger btn-icon" title="Eliminar">
              <mat-icon>delete</mat-icon>
            </button>

            <button class="btn btn-sm btn-edit btn-icon" title="Editar">
              <mat-icon>edit</mat-icon>
            </button>
          </div>
        </div>

        <!-- Nombre de la empresa, debajo de la tarjeta -->
        <p class="empresa-nombre">{{ empresa.nombre_empresa }}</p>
      </div>
    </section>

    <!-- Botón azul para abrir modal de "Agregar Empresa" -->
    <button class="btn-add" (click)="openModal()">Agregar Empresa</button>

    <!-- Modal para agregar empresa -->
    <div *ngIf="isModalOpen" class="modal">
      <div class="modal-content">
        <!-- Título centrado y con el color #388dac -->
        <h2 class="modal-title">Agregar Nueva Empresa</h2>
        <img src="assets/logo-auras_150.png" alt="Logo" class="img-fluid logo">

        <!-- Formulario del modal -->
        <form (ngSubmit)="guardarEmpresa()">
          <!-- Nombre de la empresa -->
          <div class="form-group">
            <label for="nombreEmpresa">Nombre de la empresa</label>
            <input type="text" id="nombreEmpresa" [(ngModel)]="nombreEmpresa" name="nombreEmpresa" required />
          </div>

          <!-- Nombre de la tabla -->
          <div class="form-group">
            <label for="nombreTabla">Nombre de la tabla</label>
            <input type="text" id="nombreTabla" placeholder="Nombre para su tabla" [(ngModel)]="nombreTabla" name="nombreTabla" required />
          </div>

          <!-- Subir logo -->
          <div class="form-group">
            <label for="logoEmpresa">Logo de Empresa</label>
            <input type="file" id="logoEmpresa" (change)="onLogoSelected($event)" required />
          </div>

          <!-- Paleta de colores -->
          <div class="form-group">
            <label for="colorCard">Color de tarjeta</label>
            <input type="color" id="colorCard" [(ngModel)]="colorCard" name="colorCard" required />
          </div>

          <!-- Botones de Cancelar y Guardar -->
          <div class="modal-buttons">
            <button type="button" (click)="closeModal()">Cancelar</button>
            <button type="submit">Guardar</button>
          </div>
        </form>
      </div>
    </div>
  </main>
</div>
